<!doctype html>
<html lang="tr">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Paslios - Mesajlar">
    <link href="output.css" rel="stylesheet">
    <title>Paslios - Mesajlar</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: #f9fafb;
        min-height: 100vh;
        max-width: 400px;
        margin: 0 auto;
        width: 100%;
        padding-bottom: 80px;
      }
      
      .header {
        background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
        padding: 3rem 1rem 2rem 1rem;
        width: 100vw;
        margin-left: calc(-50vw + 50%);
      }
      
      .header-container {
        max-width: 400px;
        margin: 0 auto;
        width: 100%;
      }
      
      .header-container {
        width: 100%;
      }
      
      .nav {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1rem;
      }
      
      .back-btn {
        width: 2.5rem;
        height: 2.5rem;
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        transition: all 0.2s;
      }
      
      .back-btn:hover {
        background: rgba(255, 255, 255, 0.3);
      }
      
      .nav-center h1 {
        color: white;
        font-size: 1.25rem;
        font-weight: bold;
        text-align: center;
      }
      
      .new-message-btn {
        width: 2.5rem;
        height: 2.5rem;
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        transition: all 0.2s;
      }
      
      .new-message-btn:hover {
        background: rgba(255, 255, 255, 0.3);
      }
      
      .main-content {
        flex: 1;
        max-width: 400px;
        margin: 0 auto;
        width: 100%;
        padding: 1.5rem 1rem;
      }
      
      .search-box {
        background: white;
        border-radius: 12px;
        padding: 0.75rem 1rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        border: 1px solid #f3f4f6;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      
      .search-input {
        flex: 1;
        border: none;
        outline: none;
        font-size: 1rem;
        color: #1f2937;
      }
      
      .search-input::placeholder {
        color: #9ca3af;
      }
      
      .search-icon {
        color: #9ca3af;
        font-size: 1rem;
      }
      
      .conversation-list {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }
      
      .conversation-item {
        background: white;
        border-radius: 16px;
        padding: 1rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border: 1px solid #f3f4f6;
        transition: all 0.2s;
        text-decoration: none;
        color: inherit;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: relative;
      }
      
      .conversation-item:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      
      .conversation-item.unread {
        border-left: 4px solid #10b981;
      }
      
      .user-avatar {
        width: 3rem;
        height: 3rem;
        background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #6b7280;
        position: relative;
      }
      
      .online-status {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 0.75rem;
        height: 0.75rem;
        background: #10b981;
        border: 2px solid white;
        border-radius: 50%;
      }
      
      .conversation-info {
        flex: 1;
        min-width: 0;
      }
      
      .conversation-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 0.25rem;
      }
      
      .user-name {
        color: #1f2937;
        font-weight: 600;
        font-size: 1rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      
      .message-time {
        color: #9ca3af;
        font-size: 0.75rem;
        white-space: nowrap;
      }
      
      .last-message {
        color: #6b7280;
        font-size: 0.875rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      
      .unread-count {
        background: #10b981;
        color: white;
        border-radius: 50%;
        width: 1.5rem;
        height: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: bold;
        position: absolute;
        top: 0.75rem;
        right: 0.75rem;
      }
      
      .empty-state {
        text-align: center;
        padding: 3rem 1rem;
        color: #6b7280;
      }
      
      .empty-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
      }
      
      .empty-title {
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: #374151;
      }
      
      .empty-description {
        font-size: 0.875rem;
        margin-bottom: 1.5rem;
      }
      
      .start-chat-btn {
        background: #10b981;
        color: white;
        border: none;
        border-radius: 12px;
        padding: 0.75rem 1.5rem;
        font-weight: 600;
        text-decoration: none;
        display: inline-block;
        transition: all 0.2s;
      }
      
      .start-chat-btn:hover {
        background: #059669;
        transform: translateY(-1px);
      }
      
      .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        border-top: 1px solid #f3f4f6;
        padding: 1rem;
        box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.05);
        z-index: 1000;
      }
      
      body {
        padding-bottom: 80px;
      }
      
      .nav-items {
        display: flex;
        justify-content: space-around;
        max-width: 400px;
        margin: 0 auto;
      }
      
      .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        transition: all 0.2s;
      }
      
      .nav-item.active {
        color: #10b981;
      }
      
      .nav-item:not(.active) {
        color: #6b7280;
      }
      
      .nav-item:hover {
        color: #10b981;
      }
      
      .nav-item span:first-child {
        font-size: 1.25rem;
        margin-bottom: 0.25rem;
      }
      
      .nav-item span:last-child {
        font-size: 0.75rem;
        font-weight: 500;
      }
      
      /* Toast Notifications */
      .toast {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #10b981;
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
        transition: all 0.3s ease;
        max-width: 350px;
        text-align: center;
      }
      
      .toast.show {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
      
      .toast.success {
        background: #10b981;
      }
      
      .toast.error {
        background: #ef4444;
      }
      
      .toast.info {
        background: #3b82f6;
      }

      /* Modal Styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .modal-overlay.show {
        opacity: 1;
        visibility: visible;
      }

      .modal {
        background: white;
        border-radius: 16px;
        padding: 1.5rem;
        max-width: 350px;
        width: 90%;
        margin: 1rem;
        transform: scale(0.9);
        transition: transform 0.3s ease;
      }

      .modal-overlay.show .modal {
        transform: scale(1);
      }

      .modal-title {
        font-size: 1.125rem;
        font-weight: bold;
        color: #1f2937;
        margin-bottom: 1rem;
        text-align: center;
      }

      .modal-input {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        font-size: 1rem;
        margin-bottom: 1rem;
        outline: none;
        transition: border-color 0.2s;
      }

      .modal-input:focus {
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .modal-buttons {
        display: flex;
        gap: 0.75rem;
        justify-content: center;
      }

      .modal-btn {
        padding: 0.625rem 1.25rem;
        border-radius: 8px;
        font-size: 0.875rem;
        font-weight: 500;
        border: none;
        cursor: pointer;
        transition: all 0.2s;
        min-width: 80px;
      }

      .modal-btn.primary {
        background: #10b981;
        color: white;
      }

      .modal-btn.primary:hover {
        background: #059669;
      }

      .modal-btn.secondary {
        background: #f3f4f6;
        color: #374151;
      }

      .modal-btn.secondary:hover {
        background: #e5e7eb;
      }

      .suggestion-list {
        max-height: 150px;
        overflow-y: auto;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        margin-bottom: 1rem;
      }

      .suggestion-item {
        padding: 0.75rem;
        border-bottom: 1px solid #f3f4f6;
        cursor: pointer;
        transition: background-color 0.2s;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .suggestion-item:hover {
        background: #f9fafb;
      }

      .suggestion-item:last-child {
        border-bottom: none;
      }

      .suggestion-avatar {
        width: 2rem;
        height: 2rem;
        background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #6b7280;
        font-size: 0.75rem;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <div class="header-container">
        <!-- Navigation -->
        <div class="nav">
          <a href="home.html" class="back-btn">
            <span style="color: white; font-size: 1.125rem;">←</span>
          </a>
          <div class="nav-center">
            <h1>Mesajlar</h1>
          </div>
          <a href="search.html" class="new-message-btn">
            <span style="color: white; font-size: 1.125rem;">✏️</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Search Box -->
      <div class="search-box">
        <input 
          type="text" 
          placeholder="Mesajlarda ara..."
          class="search-input"
        />
        <span class="search-icon">🔍</span>
      </div>

      <!-- Conversation List -->
      <div class="conversation-list">
        <!-- Active Conversation -->
        <a href="chat.html?user=mehmet" class="conversation-item unread">
          <div class="user-avatar">
            MK
            <div class="online-status"></div>
          </div>
          <div class="conversation-info">
            <div class="conversation-header">
              <div class="user-name">Mehmet Kaya</div>
              <div class="message-time">2 dk</div>
            </div>
            <div class="last-message">Yarın maçta görüşürüz! 🔥</div>
          </div>
          <div class="unread-count">2</div>
        </a>

        <!-- Conversation 2 -->
        <a href="chat.html?user=emre" class="conversation-item">
          <div class="user-avatar">ED</div>
          <div class="conversation-info">
            <div class="conversation-header">
              <div class="user-name">Emre Demir</div>
              <div class="message-time">1 saat</div>
            </div>
            <div class="last-message">Antalya maçından fotoğraflar geldi!</div>
          </div>
        </a>

        <!-- Team Chat -->
        <a href="chat.html?team=tigers" class="conversation-item unread">
          <div class="user-avatar" style="background: linear-gradient(135deg, #fbbf24, #f59e0b);">🐅</div>
          <div class="conversation-info">
            <div class="conversation-header">
              <div class="user-name">Çankaya Tigers</div>
              <div class="message-time">3 saat</div>
            </div>
            <div class="last-message">Can: Bu hafta antrenman var mı?</div>
          </div>
          <div class="unread-count">5</div>
        </a>

        <!-- Conversation 3 -->
        <a href="chat.html?user=can" class="conversation-item">
          <div class="user-avatar">CÖ</div>
          <div class="conversation-info">
            <div class="conversation-header">
              <div class="user-name">Can Özkan</div>
              <div class="message-time">1 gün</div>
            </div>
            <div class="last-message">Yeni ayakkabılar nasıl?</div>
          </div>
        </a>

        <!-- Conversation 4 -->
        <a href="chat.html?user=burak" class="conversation-item">
          <div class="user-avatar">
            BT
            <div class="online-status"></div>
          </div>
          <div class="conversation-info">
            <div class="conversation-header">
              <div class="user-name">Burak Tunç</div>
              <div class="message-time">2 gün</div>
            </div>
            <div class="last-message">Saha rezervasyonu yaptım ✅</div>
          </div>
        </a>

        <!-- Conversation 5 -->
        <a href="chat.html?user=ali" class="conversation-item">
          <div class="user-avatar">AS</div>
          <div class="conversation-info">
            <div class="conversation-header">
              <div class="user-name">Ali Şen</div>
              <div class="message-time">1 hafta</div>
            </div>
            <div class="last-message">👍</div>
          </div>
        </a>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
      <div class="nav-items">
        <a href="home.html" class="nav-item">
          <span>🏠</span>
          <span>Ana Sayfa</span>
        </a>
        <a href="matches.html" class="nav-item">
          <span>⚽</span>
          <span>Maçlar</span>
        </a>
        <a href="messages.html" class="nav-item active">
          <span>💌</span>
          <span>Mesajlar</span>
        </a>
        <a href="profile.html" class="nav-item">
          <span>👤</span>
          <span>Profil</span>
        </a>
      </div>
    </div>

    <script>
      let conversations = [];

      // Toast function
      function showToast(message, type = 'success') {
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.textContent = message;
        
        document.getElementById('toastContainer').appendChild(toast);
        
        // Show toast
        setTimeout(() => toast.classList.add('show'), 100);
        
        // Hide and remove toast
        setTimeout(() => {
          toast.classList.remove('show');
          setTimeout(() => toast.remove(), 300);
        }, 3000);
      }

      function initializeConversations() {
        const conversationItems = document.querySelectorAll('.conversation-item');
        conversationItems.forEach(item => {
          const userName = item.querySelector('.user-name').textContent;
          const lastMessage = item.querySelector('.last-message').textContent;
          const messageTime = item.querySelector('.message-time').textContent;
          const isUnread = item.classList.contains('unread');
          
          conversations.push({
            element: item,
            userName: userName.toLowerCase(),
            lastMessage: lastMessage.toLowerCase(),
            messageTime,
            isUnread
          });
        });
      }

      function searchConversations(query) {
        const searchTerm = query.toLowerCase().trim();
        let visibleCount = 0;

        conversations.forEach(conv => {
          const shouldShow = searchTerm === '' || 
                            conv.userName.includes(searchTerm) || 
                            conv.lastMessage.includes(searchTerm);
          
          if (shouldShow) {
            conv.element.style.display = 'flex';
            conv.element.style.animation = 'fadeIn 0.3s ease-in-out';
            visibleCount++;
          } else {
            conv.element.style.display = 'none';
          }
        });

        // Show search result message
        if (searchTerm !== '' && visibleCount === 0) {
          showNoResultsMessage();
        } else {
          hideNoResultsMessage();
        }
      }

      function showNoResultsMessage() {
        let noResultsDiv = document.querySelector('.no-results');
        if (!noResultsDiv) {
          noResultsDiv = document.createElement('div');
          noResultsDiv.className = 'no-results';
          noResultsDiv.innerHTML = `
            <div style="text-align: center; padding: 2rem; color: #6b7280;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">🔍</div>
              <div style="font-weight: 600; margin-bottom: 0.5rem;">Sonuç bulunamadı</div>
              <div style="font-size: 0.875rem;">Farklı anahtar kelimeler deneyin</div>
            </div>
          `;
          document.querySelector('.conversation-list').appendChild(noResultsDiv);
        }
        noResultsDiv.style.display = 'block';
      }

      function hideNoResultsMessage() {
        const noResultsDiv = document.querySelector('.no-results');
        if (noResultsDiv) {
          noResultsDiv.style.display = 'none';
        }
      }

      function openNewMessage() {
        showNewMessageModal();
      }

      // Modern Modal System
      function createModal(title, content) {
        const overlay = document.createElement('div');
        overlay.className = 'modal-overlay';
        overlay.innerHTML = `
          <div class="modal">
            <div class="modal-title">${title}</div>
            ${content}
          </div>
        `;
        
        document.body.appendChild(overlay);
        setTimeout(() => overlay.classList.add('show'), 100);
        
        return overlay;
      }

      function closeModal(overlay) {
        overlay.classList.remove('show');
        setTimeout(() => {
          if (overlay.parentNode) {
            document.body.removeChild(overlay);
          }
        }, 300);
      }

      function showNewMessageModal() {
        const suggestedUsers = [
          { name: 'Mert Koçak', avatar: 'MK', status: 'online' },
          { name: 'Enes Durmuş', avatar: 'ED', status: 'offline' },
          { name: 'Fatih Kaya', avatar: 'FK', status: 'online' },
          { name: 'Oğuz Şahin', avatar: 'OŞ', status: 'offline' }
        ];

        const suggestionHTML = suggestedUsers.map(user => `
          <div class="suggestion-item" onclick="selectUserFromSuggestion('${user.name}', '${user.avatar}')">
            <div class="suggestion-avatar" style="${user.status === 'online' ? 'border: 2px solid #10b981;' : ''}">${user.avatar}</div>
            <div>
              <div style="font-weight: 500; color: #1f2937;">${user.name}</div>
              <div style="font-size: 0.75rem; color: ${user.status === 'online' ? '#10b981' : '#6b7280'};">
                ${user.status === 'online' ? '🟢 Çevrimiçi' : '⚫ Çevrimdışı'}
              </div>
            </div>
          </div>
        `).join('');

        const modalContent = `
          <input 
            type="text" 
            class="modal-input" 
            id="newMessageInput"
            placeholder="Kullanıcı adı veya isim girin..."
            autocomplete="off"
          />
          <div style="margin-bottom: 1rem;">
            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem;">Önerilen kişiler:</div>
            <div class="suggestion-list">
              ${suggestionHTML}
            </div>
          </div>
          <div class="modal-buttons">
            <button class="modal-btn secondary" onclick="closeCurrentModal()">İptal</button>
            <button class="modal-btn primary" onclick="startNewChat()">Mesaj Gönder</button>
          </div>
        `;

        const modal = createModal('Yeni Mesaj', modalContent);
        window.currentModal = modal;

        // Auto-focus input
        setTimeout(() => {
          const input = document.getElementById('newMessageInput');
          if (input) {
            input.focus();
            
            // Add Enter key support
            input.addEventListener('keypress', (e) => {
              if (e.key === 'Enter' && input.value.trim()) {
                startNewChat();
              }
            });

            // Live search suggestions
            input.addEventListener('input', (e) => {
              filterSuggestions(e.target.value);
            });
          }
        }, 150);
      }

      function selectUserFromSuggestion(userName, avatar) {
        const input = document.getElementById('newMessageInput');
        if (input) {
          input.value = userName;
        }
        startNewChat();
      }

      function filterSuggestions(query) {
        const suggestions = document.querySelectorAll('.suggestion-item');
        const searchTerm = query.toLowerCase();

        suggestions.forEach(item => {
          const userName = item.textContent.toLowerCase();
          if (searchTerm === '' || userName.includes(searchTerm)) {
            item.style.display = 'flex';
          } else {
            item.style.display = 'none';
          }
        });
      }

      function startNewChat() {
        const input = document.getElementById('newMessageInput');
        const contact = input ? input.value.trim() : '';
        
        if (contact) {
          closeCurrentModal();
          showToast(`${contact} ile yeni sohbet başlatılıyor... 💬`, 'success');
          
          setTimeout(() => {
            window.location.href = `chat.html?user=${encodeURIComponent(contact)}`;
          }, 1500);
        } else {
          showToast('⚠️ Lütfen bir kullanıcı adı girin!', 'error');
        }
      }

      function closeCurrentModal() {
        if (window.currentModal) {
          closeModal(window.currentModal);
          window.currentModal = null;
        }
      }

      function markAsRead(conversationElement) {
        const unreadCount = conversationElement.querySelector('.unread-count');
        if (unreadCount) {
          unreadCount.style.display = 'none';
        }
        conversationElement.classList.remove('unread');
      }

      function longPressAction(conversationElement, userName) {
        showConversationOptionsModal(conversationElement, userName);
      }

      function showConversationOptionsModal(conversationElement, userName) {
        const options = [
          { 
            text: 'Okundu olarak işaretle', 
            icon: '✓', 
            action: () => markAsRead(conversationElement)
          },
          { 
            text: 'Sohbeti sil', 
            icon: '🗑️', 
            action: () => deleteConversation(conversationElement, userName),
            danger: true
          },
          { 
            text: 'Kullanıcıyı engelle', 
            icon: '🚫', 
            action: () => blockUser(conversationElement, userName),
            danger: true
          },
          { 
            text: 'Profili görüntüle', 
            icon: '👤', 
            action: () => viewProfile(userName)
          }
        ];

        const optionsHTML = options.map(option => `
          <div class="suggestion-item" onclick="handleConversationAction('${option.text}', '${userName}')" 
               style="${option.danger ? 'color: #ef4444;' : ''}">
            <div style="width: 2rem; text-align: center; font-size: 1.25rem;">${option.icon}</div>
            <div style="font-weight: 500;">${option.text}</div>
          </div>
        `).join('');

        const modalContent = `
          <div style="margin-bottom: 1rem;">
            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem;">
              ${userName} sohbeti için seçenekler:
            </div>
            <div class="suggestion-list">
              ${optionsHTML}
            </div>
          </div>
          <div class="modal-buttons">
            <button class="modal-btn secondary" onclick="closeCurrentModal()">İptal</button>
          </div>
        `;

        const modal = createModal('Sohbet Seçenekleri', modalContent);
        window.currentModal = modal;
        window.currentConversationElement = conversationElement;
      }

      function handleConversationAction(actionText, userName) {
        const element = window.currentConversationElement;
        
        switch(actionText) {
          case 'Okundu olarak işaretle':
            markAsRead(element);
            showToast('Sohbet okundu olarak işaretlendi ✓', 'success');
            break;
          case 'Sohbeti sil':
            deleteConversation(element, userName);
            break;
          case 'Kullanıcıyı engelle':
            blockUser(element, userName);
            break;
          case 'Profili görüntüle':
            viewProfile(userName);
            break;
        }
        
        closeCurrentModal();
      }

      function deleteConversation(element, userName) {
        closeCurrentModal();
        
        const confirmModal = createModal(
          'Sohbeti Sil',
          `
            <div style="text-align: center; margin-bottom: 1.5rem;">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">🗑️</div>
              <div style="color: #6b7280; font-size: 0.875rem;">
                ${userName} ile olan sohbeti silmek istediğinizden emin misiniz?
                <br><br>
                <strong style="color: #ef4444;">Bu işlem geri alınamaz!</strong>
              </div>
            </div>
            <div class="modal-buttons">
              <button class="modal-btn secondary" onclick="closeCurrentModal()">İptal</button>
              <button class="modal-btn primary" style="background: #ef4444;" onclick="confirmDeleteConversation()">Sil</button>
            </div>
          `
        );
        
        window.currentModal = confirmModal;
        window.elementToDelete = element;
        window.userToDelete = userName;
      }

      function confirmDeleteConversation() {
        const element = window.elementToDelete;
        const userName = window.userToDelete;
        
        element.style.animation = 'fadeOut 0.3s ease-in-out';
        setTimeout(() => element.remove(), 300);
        showToast(`${userName} sohbeti silindi 🗑️`, 'info');
        
        closeCurrentModal();
      }

      function blockUser(element, userName) {
        closeCurrentModal();
        
        const confirmModal = createModal(
          'Kullanıcıyı Engelle',
          `
            <div style="text-align: center; margin-bottom: 1.5rem;">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">🚫</div>
              <div style="color: #6b7280; font-size: 0.875rem;">
                ${userName} kullanıcısını engellemek istediğinizden emin misiniz?
                <br><br>
                Engellenen kullanıcı:
                <br>• Size mesaj gönderemez
                <br>• Gönderilerinizi göremez
                <br>• Sizi arayamaz
              </div>
            </div>
            <div class="modal-buttons">
              <button class="modal-btn secondary" onclick="closeCurrentModal()">İptal</button>
              <button class="modal-btn primary" style="background: #ef4444;" onclick="confirmBlockUser()">Engelle</button>
            </div>
          `
        );
        
        window.currentModal = confirmModal;
        window.elementToBlock = element;
        window.userToBlock = userName;
      }

      function confirmBlockUser() {
        const element = window.elementToBlock;
        const userName = window.userToBlock;
        
        showToast(`${userName} engellendi 🚫`, 'error');
        element.style.opacity = '0.5';
        element.style.pointerEvents = 'none';
        
        closeCurrentModal();
      }

      function viewProfile(userName) {
        showToast(`${userName} profiline yönlendiriliyor... 👤`, 'info');
        setTimeout(() => {
          window.location.href = `user-profile.html?user=${encodeURIComponent(userName)}`;
        }, 1500);
      }

      // Add event listeners
      document.addEventListener('DOMContentLoaded', function() {
        initializeConversations();

        // Search functionality
        const searchInput = document.querySelector('.search-input');
        searchInput.addEventListener('input', (e) => {
          searchConversations(e.target.value);
        });

        // Clear search on focus
        searchInput.addEventListener('focus', () => {
          if (searchInput.value === '') {
            searchConversations('');
          }
        });

        // New message button
        const newMessageBtn = document.querySelector('.new-message-btn');
        newMessageBtn.addEventListener('click', (e) => {
          e.preventDefault();
          openNewMessage();
        });

        // Long press for conversation options
        let pressTimer;
        document.querySelectorAll('.conversation-item').forEach(item => {
          // Mouse events
          item.addEventListener('mousedown', () => {
            pressTimer = setTimeout(() => {
              const userName = item.querySelector('.user-name').textContent;
              longPressAction(item, userName);
            }, 1000);
          });

          item.addEventListener('mouseup', () => {
            clearTimeout(pressTimer);
          });

          item.addEventListener('mouseleave', () => {
            clearTimeout(pressTimer);
          });

          // Touch events for mobile
          item.addEventListener('touchstart', () => {
            pressTimer = setTimeout(() => {
              const userName = item.querySelector('.user-name').textContent;
              longPressAction(item, userName);
            }, 1000);
          });

          item.addEventListener('touchend', () => {
            clearTimeout(pressTimer);
          });

          // Click event to open chat
          item.addEventListener('click', (e) => {
            if (e.detail === 1) { // Single click
              setTimeout(() => {
                if (!e.defaultPrevented) {
                  markAsRead(item);
                  // Navigate to chat page
                  const userName = item.querySelector('.user-name').textContent;
                  showToast(`${userName} ile sohbet açılıyor... 💬`, 'success');
                }
              }, 200);
            }
          });
        });

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
          @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
          }
          @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-10px); }
          }
          .conversation-item:active {
            transform: scale(0.98);
          }
        `;
        document.head.appendChild(style);

        // ESC key modal close
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape' && window.currentModal) {
            closeCurrentModal();
          }
        });

        // Click outside modal to close
        document.addEventListener('click', function(e) {
          if (window.currentModal && e.target.classList.contains('modal-overlay')) {
            closeCurrentModal();
          }
        });

        // Oturum kontrolü ve mesajları yükle
        if (!PasliosData.isLoggedIn()) {
          window.location.href = 'index.html';
          return;
        }
        
        loadConversations();
      });

      function loadConversations() {
        const currentUser = PasliosData.getCurrentUser();
        const allUsers = PasliosData.getData('users');
        const messages = PasliosData.getData('messages') || [];
        
        // Konuşma listesi oluştur (basit yaklaşım)
        const conversationList = document.querySelector('.conversation-list');
        const demoConversations = [
          { userId: 2, name: 'Mehmet Kaya', avatar: 'MK', lastMessage: 'Yarın maçta görüşürüz! 🔥', time: '2 dk', unread: 2, online: true },
          { userId: 3, name: 'Emre Demir', avatar: 'ED', lastMessage: 'Antalya maçından fotoğraflar geldi!', time: '1 saat', unread: 0, online: false },
          { userId: 4, name: 'Can Özkan', avatar: 'CÖ', lastMessage: 'Yeni ayakkabılar nasıl?', time: '1 gün', unread: 0, online: false },
          { userId: 5, name: 'Burak Tunç', avatar: 'BT', lastMessage: 'Saha rezervasyonu yaptım ✅', time: '2 gün', unread: 0, online: true },
          { userId: 6, name: 'Ali Şen', avatar: 'AS', lastMessage: '👍', time: '1 hafta', unread: 0, online: false }
        ];

        conversationList.innerHTML = demoConversations.map(conv => `
          <a href="chat.html?user=${conv.userId}" class="conversation-item ${conv.unread > 0 ? 'unread' : ''}">
            <div class="user-avatar">
              ${conv.avatar}
              ${conv.online ? '<div class="online-status"></div>' : ''}
            </div>
            <div class="conversation-info">
              <div class="conversation-header">
                <div class="user-name">${conv.name}</div>
                <div class="message-time">${conv.time}</div>
              </div>
              <div class="last-message">${conv.lastMessage}</div>
            </div>
            ${conv.unread > 0 ? `<div class="unread-count">${conv.unread}</div>` : ''}
          </a>
        `).join('');

        // Team chat ekle
        conversationList.innerHTML = `
          <a href="chat.html?team=tigers" class="conversation-item unread">
            <div class="user-avatar" style="background: linear-gradient(135deg, #fbbf24, #f59e0b);">🐅</div>
            <div class="conversation-info">
              <div class="conversation-header">
                <div class="user-name">Çankaya Tigers</div>
                <div class="message-time">3 saat</div>
              </div>
              <div class="last-message">Can: Bu hafta antrenman var mı?</div>
            </div>
            <div class="unread-count">5</div>
          </a>
        ` + conversationList.innerHTML;
      }
    </script>

    <!-- Data Management Script -->
    <script src="js/data.js"></script>

    <!-- Toast Container -->
    <div id="toastContainer"></div>
  </body>
</html>
